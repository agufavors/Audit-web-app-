<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Visibility Audit Tool</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
:root {
  --blue:#00c6ff;
  --green:#00f260;
  --purple:#9b5de5;
  --orange:#f15bb5;
  --card:#ffffffdd;
  --muted:#555;
  font-family:'Poppins',sans-serif;
}
body{
  margin:0;
  background:linear-gradient(135deg,var(--blue),var(--green));
  min-height:100vh;
  padding:24px;
}
.container{
  max-width:1100px;
  margin:auto;
}
header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:18px;
  color:white;
}
.logo{
  font-weight:700;
  font-size:24px;
}
.btn{
  border:none;
  padding:10px 14px;
  border-radius:10px;
  cursor:pointer;
  font-weight:600;
  background:linear-gradient(90deg,var(--purple),var(--orange));
  color:white;
}
.small{padding:6px 10px;font-size:13px}
input{
  padding:10px;
  border-radius:8px;
  border:1px solid #ccc;
  font-family:inherit;
}
.card{
  background:var(--card);
  border-radius:14px;
  padding:18px;
  box-shadow:0 10px 30px rgba(0,0,0,0.15);
}
.layout{
  display:grid;
  grid-template-columns:1fr 350px;
  gap:18px;
}
.muted{color:var(--muted);font-size:14px}
.report-item{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:10px;
  border-radius:10px;
  background:#f5fefe;
  border:1px solid #e2f2f2;
}
table{
  width:100%;
  border-collapse:collapse;
}
th,td{
  padding:8px;
  border-bottom:1px solid #eee;
  text-align:left;
}
@media(max-width:900px){
  .layout{grid-template-columns:1fr}
}
</style>
</head>
<body>

<div class="container">

<header>
  <div class="logo">üîç Visibility Audit</div>
  <div class="muted">Check website & Google Business Profile</div>
</header>

<!-- Audit Form -->
<section class="card" style="margin-bottom:18px">
  <h2>Run Business Audit</h2>
  <p class="muted">Check website & Google Business Profile visibility</p>

  <div style="display:grid;gap:10px;max-width:500px">
    <input id="bizName" placeholder="Business name">
    <input id="bizWebsite" placeholder="Website URL (https://...)">
    <input id="bizGBP" placeholder="Google Business Profile link">
    <button class="btn" onclick="runAudit()">Run Audit</button>
  </div>
</section>

<div class="layout">

<!-- Reports Section -->
<main class="card">
  <h3>Audit Reports</h3>
  <div id="reportsList" style="display:flex;flex-direction:column;gap:10px;margin-top:12px"></div>
</main>

<!-- Info / Sidebar -->
<aside class="card">
  <h3>Checks performed</h3>
  <ul class="muted">
    <li>Website availability</li>
    <li>HTTPS security</li>
    <li>Google Business Profile presence</li>
    <li>Basic readiness score</li>
  </ul>
  <p class="muted">Reports can be downloaded as PDF or copied.</p>
</aside>

</div>

<footer class="muted" style="margin-top:18px;text-align:center">
  Built with üíôüíö by Favs Agu
</footer>

</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>

<script>
let reports=[];

// Escape text for HTML
function escapeHtml(s){
  if(!s) return '';
  return String(s).replace(/[&<>\"']/g, function(c){
    return {'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":"&#39;"}[c];
  });
}

// Run audit
function runAudit(){
  const name=bizName.value.trim();
  const website=bizWebsite.value.trim();
  const gbp=bizGBP.value.trim();

  if(!name) return alert("Business name is required");

  let score=0;
  let findings=[];

  if(website){
    score+=30;
    if(website.startsWith("https://")){
      score+=10;
    } else {
      findings.push({id:'W1',desc:'Website is not HTTPS',severity:'Medium',status:'Open'});
    }
  } else {
    findings.push({id:'W0',desc:'No website provided',severity:'High',status:'Open'});
  }

  if(gbp){
    score+=40;
  } else {
    findings.push({id:'G1',desc:'Google Business Profile missing',severity:'High',status:'Open'});
  }

  if(score>100) score=100;

  const report={
    id:'R-'+(1000+reports.length+1),
    title:`Audit Report ‚Äî ${name}`,
    date:new Date().toISOString().slice(0,10),
    summary:`Audit completed for ${name}. Overall score: ${score}/100.`,
    findings:findings.length?findings:[{id:'OK',desc:'No critical issues detected',severity:'Low',status:'Closed'}]
  };

  reports.unshift(report);
  renderReports();
  openReport(report.id);
}

// Render reports list
function renderReports(){
  const list=document.getElementById('reportsList');
  list.innerHTML='';
  reports.forEach(r=>{
    const div=document.createElement('div');
    div.className='report-item';
    div.innerHTML=`
      <div>
        <strong>${r.title}</strong>
        <div class="muted">${r.date}</div>
      </div>
      <div style="display:flex;gap:6px">
        <button class="small" onclick="openReport('${r.id}')">Open</button>
        <button class="small" onclick="exportPDF('${r.id}')">PDF</button>
      </div>`;
    list.appendChild(div);
  });
}

// Open report modal
function openReport(id){
  const r=reports.find(x=>x.id===id);
  if(!r) return;

  const modal=document.createElement('div');
  modal.style.position='fixed';
  modal.style.inset='0';
  modal.style.background='rgba(0,0,0,0.6)';
  modal.style.display='flex';
  modal.style.alignItems='center';
  modal.style.justifyContent='center';
  modal.innerHTML=`
    <div class="card" id="printable" style="max-width:800px;width:90%;max-height:90vh;overflow:auto">
      <h2>${escapeHtml(r.title)}</h2>
      <p class="muted">${r.date}</p>
      <p>${escapeHtml(r.summary)}</p>
      <h3>Findings</h3>
      <table>
        <tr><th>ID</th><th>Description</th><th>Severity</th><th>Status</th></tr>
        ${r.findings.map(f=>`<tr><td>${f.id}</td><td>${escapeHtml(f.desc)}</td><td>${f.severity}</td><td>${f.status}</td></tr>`).join('')}
      </table>
      <div style="margin-top:12px;display:flex;gap:8px">
        <button class="btn" onclick="exportPDF('${r.id}')">Download PDF</button>
        <button class="small" onclick="this.closest('div[style]').parentElement.remove()">Close</button>
      </div>
    </div>`;
  document.body.appendChild(modal);
}

// Export report as PDF
function exportPDF(id){
  const r=reports.find(x=>x.id===id);
  if(!r) return;
  const el=document.getElementById('printable');
  html2pdf().from(el).save(`${r.title}.pdf`);
}
</script>

</body>
</html>
